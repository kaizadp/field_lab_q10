---
title: "data analysis"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      collapse = TRUE,
                      warning = FALSE,
                      message = FALSE,
                      comment = "#>"
                      )
```

---

## EXPLORATION

### Study sites

```{r, fig.height=7}
readd(Q10_map)$gg_facet
```

```{r, fig.height=4, fig.width=8}
readd(Q10_map)$gg_species
```


### How many datapoints?

Datapoints: 

```{r}
readd(study_summary)$datapoints %>% knitr::kable()
```

Studies: 

```{r}
readd(study_summary)$study_counts %>% knitr::kable()
```


### Studies by Climate

```{r, fig.height=7, fig.width=4.5}
readd(gg_mat_map)
```


### Incubation Temperature Ranges

```{r}
readd(gg_temp_ranges)
```


```{r, eval=FALSE}
readd(Q10_data) %>% 
  group_by(Incubation, Ecosystem_type) %>% 
  dplyr::summarise(n = n()) %>% 
  pivot_wider(names_from = "Incubation", values_from = "n") %>% 
  arrange(Ecosystem_type) %>% 
  knitr::kable()
```

```{r, eval=FALSE}
readd(Q10_data) %>% 
  group_by(Incubation, Biome) %>% 
  dplyr::summarise(n = n())%>% 
  pivot_wider(names_from = "Incubation", values_from = "n") %>% 
  arrange(Biome) %>% 
  knitr::kable()
```


---

## Analysis - CO2

### Summary tables

```{r}
loadd(summary_tables)$summary_overall %>% knitr::kable()
```

```{r}
loadd(summary_tables)$summary_biome %>% knitr::kable()

```

```{r}
loadd(summary_tables)$summary_temp %>% knitr::kable()

```




### All studies, all temperatures

We included all datapoints collected, irrespective of incubation temperature range. (0-10 C, 0-15 C, 0-20 C, 10-20 C, 5-15 C, etc.)

```{r, fig.height=4, fig.width=4}
readd(co2_all)$gg_raincloud_all
readd(co2_all)$aov_all
```


We then subset the data to include only incubations with temperature ranges of 10 C. (0-10 C, 10-20 C, 5-15 C, 15-25 C, etc.)

```{r, fig.height=4, fig.width=4}
readd(co2_all)$gg_raincloud_tenC
readd(co2_all)$aov_tenC

```


### Subsetting by temperature range

We then subset the data to include only incubations with specific temperature ranges: < 5 C, 5-15 C, 15-25 C, > 25C. These ranges were chosen because these ranges had the highest frequency of data, and this would also avoid issues pertaining to frozen soils (if we were tp choose 0-10 C).


```{r, fig.height=4, fig.width=7}
readd(co2_temp_range)$resp_q10_temp_raincloud
readd(co2_temp_range)$co2_aov_temp
```

### Grouping by biome

```{r, fig.height=3, fig.width=9}
readd(co2_biome)
```


### Bootstrapping the data

The data were highly skewed toward the field measurements, because most came from the highly curated SRDB. To do a more balanced analysis, we did bootstrapping by randomly sampling 1000 times, 10 samples each. 

```{r, fig.height=4, fig.width=7}
readd(co2_bootstrapping)$gg_boot_raincloud
readd(co2_bootstrapping)$gg_boot_density
readd(co2_bootstrapping)$boot_aov
```

### Combining non-bootstrap and bootstrap plots

```{r, fig.height=7, fig.width=7}
library(patchwork)

non_boot = readd(co2_temp_range)$resp_q10_temp_raincloud
boot = readd(co2_bootstrapping)$gg_boot_raincloud

non_boot / boot

```




### Heterotrophic respiration

The field measurements reported above included both autotrophic and heterotrophic respiration, whereas the lab measurements refer only to heterotrophic. We subset field measurements that were heterotrophic respiration only, and compared that with lab.

The heterotrophic field measurements were available for temperate and snow biomes only.

```{r, fig.height=4, fig.width=4}
readd(Q10_rh_only)$rh_raincloud_plot
readd(Q10_rh_only)$rh_raincloud_biomes
readd(Q10_rh_only)$rh_aov
readd(Q10_rh_only)$rh_summary

```

---

## Analysis - CH4

```{r, fig.height=4, fig.width=4}
readd(ch4_all)$gg_ch4_raincloud
readd(ch4_all)$ch4_aov
```



---

<details>   
   <summary>Session Info</summary>
   
Date run: `r Sys.Date()`

```{r}
sessionInfo()
```

</details> 